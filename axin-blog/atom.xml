<?xml version="1.0" encoding="utf-8"?>
<feed xmlns="http://www.w3.org/2005/Atom">
  <title>axin-blog</title>
  
  <subtitle>学无止境，及时记录</subtitle>
  <link href="/atom.xml" rel="self"/>
  
  <link href="http://www.axin-blog.com/"/>
  <updated>2020-08-27T02:26:33.089Z</updated>
  <id>http://www.axin-blog.com/</id>
  
  <author>
    <name>Axin</name>
    
  </author>
  
  <generator uri="https://hexo.io/">Hexo</generator>
  
  <entry>
    <title>FLIP动画简介</title>
    <link href="http://www.axin-blog.com/uncategorized/FLIP%E5%8A%A8%E7%94%BB%E7%AE%80%E4%BB%8B/"/>
    <id>http://www.axin-blog.com/uncategorized/FLIP%E5%8A%A8%E7%94%BB%E7%AE%80%E4%BB%8B/</id>
    <published>2020-08-24T12:03:56.000Z</published>
    <updated>2020-08-27T02:26:33.089Z</updated>
    
    <content type="html"><![CDATA[<h1 id="今天的目标"><a href="#今天的目标" class="headerlink" title="今天的目标"></a>今天的目标</h1><p><img src="/assets/FLIP%E5%8A%A8%E7%94%BB%E7%AE%80%E4%BB%8B/flip-demo.gif" alt="flip-demo"></p><h1 id="FLIP简介"><a href="#FLIP简介" class="headerlink" title="FLIP简介"></a>FLIP简介</h1><p><code>FLIP</code> 是将一些开销高昂的动画，如针对 <code>width</code>，<code>height</code>，<code>left</code> 或 <code>top</code> 的动画，映射为 <code>transform</code> 动画。通过记录元素的两个快照，一个是元素的初始位置（First - <code>F</code>），另一个是元素的最终位置（Last - <code>L</code>），然后对元素使用一个 transform 变换来反转（Invert - <code>I</code>），让元素看起来还在初始位置，最后移除元素上的 transform 使元素由初始位置运动（Play - <code>P</code>）到最终位置。</p><p>所以 FLIP 来源于 <code>F</code>irst，<code>L</code>ast，<code>I</code>nvert，<code>P</code>lay</p><ul><li><code>F</code>: <code>first</code>, 元素的初始状态</li><li><code>L</code>: <code>last</code>, 元素的结束状态</li><li><code>I</code>: <code>invert</code>, 倒置，把始末的状态导致过来</li><li><code>P</code>: <code>play</code>, 播放动画</li></ul><h1 id="需理解的前提知识"><a href="#需理解的前提知识" class="headerlink" title="需理解的前提知识"></a>需理解的前提知识</h1><h2 id="1-浏览器的事件执行顺序"><a href="#1-浏览器的事件执行顺序" class="headerlink" title="1.浏览器的事件执行顺序"></a>1.浏览器的事件执行顺序</h2><p><img src="/assets/FLIP%E5%8A%A8%E7%94%BB%E7%AE%80%E4%BB%8B/event-loop.png" alt="event-loop"></p><h3 id="三个小例子"><a href="#三个小例子" class="headerlink" title="三个小例子"></a>三个小例子</h3><p>一次宏任务执行完毕之后,浏览器才会渲染</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">document</span>.body.style = <span class="string">'background:black'</span>;</span><br><span class="line"><span class="built_in">document</span>.body.style = <span class="string">'background:red'</span>;</span><br><span class="line"><span class="built_in">document</span>.body.style = <span class="string">'background:blue'</span>;</span><br><span class="line"><span class="built_in">document</span>.body.style = <span class="string">'background:grey'</span>;</span><br></pre></td></tr></table></figure><p>宏任务–&gt;渲染–&gt;宏任务</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">document</span>.body.style = <span class="string">'background:blue'</span>;</span><br><span class="line">setTimeout(<span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">    <span class="built_in">document</span>.body.style = <span class="string">'background:black'</span></span><br><span class="line">&#125;,<span class="number">0</span>)</span><br></pre></td></tr></table></figure><p>宏任务–&gt;微任务–&gt;渲染</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">document</span>.body.style = <span class="string">'background:blue'</span>;</span><br><span class="line"><span class="built_in">Promise</span>.resolve().then(<span class="function"><span class="params">()</span> =&gt;</span> &#123;</span><br><span class="line">  <span class="built_in">document</span>.body.style = <span class="string">'background:black'</span></span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure><h2 id="2-getBoundingClientRect"><a href="#2-getBoundingClientRect" class="headerlink" title="2.getBoundingClientRect"></a>2.getBoundingClientRect</h2><p><a href="https://developer.mozilla.org/zh-CN/docs/Web/API/Element/getBoundingClientRect" target="_blank" rel="noopener">Element.getBoundingClientRect()</a>  方法返回元素的大小及其相对于视口的位置。</p><div class="block tip-block"><p>使用这个api的真正目的在于它能够强制浏览器同步当前元素的位置</p></div><h2 id="3-为什么使用tranform-opacity-等属性做动画会比直接改变Left-top等属性做动画更好"><a href="#3-为什么使用tranform-opacity-等属性做动画会比直接改变Left-top等属性做动画更好" class="headerlink" title="3.为什么使用tranform, opacity 等属性做动画会比直接改变Left,top等属性做动画更好"></a>3.为什么使用<code>tranform</code>, <code>opacity</code> 等属性做动画会比直接改变<code>Left</code>,<code>top</code>等属性做动画更好</h2><p>为了生成流畅的动画，你需要让浏览器尽可能少地工作，最好的办法就是充分利用 GPU，并避免动画过程中触发页面重排或重绘。目前 Chrome，Firefox，Safari，Opera 和 IE11 都对 <code>transform</code>（<code>translate</code>，<code>rotate</code> 和 <code>scale</code>） 和 <code>opacity</code> 进行硬件加速。所以我们应该尽量使用 <code>transform</code> 和 <code>opacity</code> 属性来实现我们的动画.</p><h1 id="伪代码"><a href="#伪代码" class="headerlink" title="伪代码"></a>伪代码</h1><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 获取初始位置</span></span><br><span class="line"><span class="keyword">var</span> first = el.getBoundingClientRect();</span><br><span class="line"></span><br><span class="line"><span class="comment">// 让元素在最终位置上.可以通过直接设置class,改变兄弟元素等等方式都行</span></span><br><span class="line">el.classList.add(<span class="string">'class-end'</span>);</span><br><span class="line"></span><br><span class="line"><span class="comment">// 获取最终位置</span></span><br><span class="line"><span class="keyword">var</span> last = el.getBoundingClientRect();</span><br><span class="line"></span><br><span class="line"><span class="comment">// 计算反转</span></span><br><span class="line"><span class="keyword">var</span> invert = first.top - last.top;</span><br><span class="line"></span><br><span class="line"><span class="comment">// 反转</span></span><br><span class="line">el.style.transform = <span class="string">'translateY('</span> + invert + <span class="string">'px)'</span>;</span><br><span class="line"></span><br><span class="line"><span class="comment">// 播放</span></span><br><span class="line">setTimeout(<span class="function"><span class="keyword">function</span>(<span class="params"></span>) </span>&#123; </span><br><span class="line">  <span class="comment">// 添加动画相关的设置</span></span><br><span class="line">  el.classList.add(<span class="string">'animate-on-transforms'</span>);</span><br><span class="line">  <span class="comment">// 开始动画</span></span><br><span class="line">  el.style.transform = <span class="string">''</span>; </span><br><span class="line">&#125;, <span class="number">0</span>);</span><br><span class="line"></span><br><span class="line"><span class="comment">// 结束时清理</span></span><br><span class="line">el.addEventListener(<span class="string">'transitionend'</span>, () =&gt; &#123;</span><br><span class="line">  el.classList.remove(<span class="string">'animate-on-transforms'</span>);</span><br><span class="line">  <span class="comment">// ...</span></span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure><h1 id="实现"><a href="#实现" class="headerlink" title="实现"></a>实现</h1><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;!DOCTYPE <span class="meta-keyword">html</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">html</span> <span class="attr">lang</span>=<span class="string">"en"</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;<span class="name">head</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">meta</span> <span class="attr">charset</span>=<span class="string">"UTF-8"</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">meta</span> <span class="attr">name</span>=<span class="string">"viewport"</span> <span class="attr">content</span>=<span class="string">"width=device-width, initial-scale=1.0"</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">title</span>&gt;</span>flip-animation-demo<span class="tag">&lt;/<span class="name">title</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">style</span>&gt;</span></span><br><span class="line"><span class="css">    <span class="selector-class">.container</span> &#123;</span></span><br><span class="line">      display: flex;</span><br><span class="line">      flex-wrap: wrap;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    img &#123;</span><br><span class="line">      display: inline-block;</span><br><span class="line">      width: 110px;</span><br><span class="line">      height: 110px;</span><br><span class="line">      margin: 5px;</span><br><span class="line">    &#125;</span><br><span class="line">  <span class="tag">&lt;/<span class="name">style</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">head</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;<span class="name">body</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">div</span> <span class="attr">id</span>=<span class="string">"container"</span>&gt;</span><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line"></span><br><span class="line">  <span class="tag">&lt;<span class="name">script</span>&gt;</span></span><br><span class="line"><span class="actionscript">    <span class="function"><span class="keyword">function</span> <span class="title">insert</span><span class="params">(count)</span> </span>&#123;</span></span><br><span class="line"><span class="actionscript">      <span class="keyword">const</span> allImgs = container.querySelectorAll(<span class="string">'img'</span>);</span></span><br><span class="line"></span><br><span class="line"><span class="javascript">      allImgs.forEach(<span class="function"><span class="params">img</span> =&gt;</span> &#123;</span></span><br><span class="line"><span class="actionscript">        <span class="comment">// 先记录下原始位置 FIRST</span></span></span><br><span class="line"><span class="actionscript">        <span class="keyword">const</span> &#123; left, top &#125; = img.getBoundingClientRect();</span></span><br><span class="line">        img._top = top;</span><br><span class="line">        img._left = left;</span><br><span class="line">      &#125;)</span><br><span class="line"></span><br><span class="line">      count = count || 1;</span><br><span class="line"><span class="javascript">      <span class="keyword">for</span> (<span class="keyword">let</span> i = <span class="number">0</span>; i &lt; count; i++) &#123;</span></span><br><span class="line"><span class="javascript">        <span class="keyword">const</span> img = <span class="built_in">document</span>.createElement(<span class="string">'img'</span>);</span></span><br><span class="line"><span class="javascript">        <span class="keyword">const</span> random = <span class="built_in">Math</span>.floor(<span class="built_in">Math</span>.random() * <span class="number">9</span>) + <span class="number">1</span>;</span></span><br><span class="line"><span class="javascript">        img.src = <span class="string">`./images/<span class="subst">$&#123;random&#125;</span>.jpeg`</span>;</span></span><br><span class="line">        container.insertBefore(img, container.firstChild);</span><br><span class="line">        </span><br><span class="line"><span class="actionscript">        <span class="comment">// 绑定事件，动画结束之后清空transition和transform</span></span></span><br><span class="line"><span class="actionscript">        img.addEventListener(<span class="string">'transitionend'</span>, () =&gt; &#123;</span></span><br><span class="line"><span class="actionscript">          img.style.transition = <span class="string">''</span>;</span></span><br><span class="line"><span class="actionscript">          img.style.transform = <span class="string">''</span>;</span></span><br><span class="line">        &#125;);</span><br><span class="line">      &#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="javascript">      allImgs.forEach(<span class="function"><span class="params">img</span> =&gt;</span> &#123;</span></span><br><span class="line"><span class="actionscript">        <span class="comment">// 得到现在的位置 Last</span></span></span><br><span class="line"><span class="actionscript">        <span class="keyword">const</span> &#123; left, top &#125; = img.getBoundingClientRect();</span></span><br><span class="line"><span class="actionscript">        <span class="comment">// 倒置 Invert</span></span></span><br><span class="line"><span class="actionscript">        <span class="keyword">const</span> top_distance = img._top - top;</span></span><br><span class="line"><span class="actionscript">        <span class="keyword">const</span> left_distance = img._left - left;</span></span><br><span class="line"><span class="javascript">        img.style.transform = <span class="string">`translate(<span class="subst">$&#123;left_distance&#125;</span>px, <span class="subst">$&#123;top_distance&#125;</span>px)`</span>;</span></span><br><span class="line"><span class="actionscript">        <span class="comment">// Play</span></span></span><br><span class="line"><span class="javascript">        setTimeout(<span class="function"><span class="params">()</span> =&gt;</span> &#123;</span></span><br><span class="line"><span class="actionscript">          img.style.transition = <span class="string">'all .5s'</span>;</span></span><br><span class="line"><span class="actionscript">          img.style.transform = <span class="string">'none'</span>;</span></span><br><span class="line">        &#125;, 0);</span><br><span class="line">      &#125;);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line"><span class="actionscript">    <span class="comment">// setInterval(insert, 2000)</span></span></span><br><span class="line"></span><br><span class="line">  <span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;/<span class="name">body</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;/<span class="name">html</span>&gt;</span></span><br></pre></td></tr></table></figure><div class="block tip-block"><p>图片资源请自行寻找.本例子是选了9张图片分别命名为<code>1-9.jpeg</code>,放在与html同级目录下的<code>images</code>文件夹中</p></div><h1 id="FAQ"><a href="#FAQ" class="headerlink" title="FAQ"></a>FAQ</h1><h2 id="FLIP-适合用在什么地方"><a href="#FLIP-适合用在什么地方" class="headerlink" title="FLIP 适合用在什么地方"></a>FLIP 适合用在什么地方</h2><ul><li>两个状态的过度</li><li>元素增加,移除</li><li>展开,收缩</li><li>打乱顺序/重新排列</li></ul><h2 id="为什么要用倒置-而不是通过加transform直接从开始到结束"><a href="#为什么要用倒置-而不是通过加transform直接从开始到结束" class="headerlink" title="为什么要用倒置,而不是通过加transform直接从开始到结束"></a>为什么要用倒置,而不是通过加transform直接从开始到结束</h2><ul><li>很难知道结束的位置,步骤繁琐,难以理解</li><li>从开始到结束的时候,浏览器需要计算结束的位置.导致过来的时候,浏览器其实已经知道了结束的位置.更快.</li><li>一直用从开始到结束的话,需要一直去维护transform的值,且容易弄脏css</li></ul><h2 id="对性能的影响"><a href="#对性能的影响" class="headerlink" title="对性能的影响"></a>对性能的影响</h2><p>从交互结束到感知到响应大概需要 100ms 的生理反应时间,如果网站能在这 100ms 内做出响应，那么对用户来说就相当于网站立即进行了响应，然后只需要保证动画在 60FPS 运行就能给用户带来最佳的体验.我们可以充分利用用户 100ms 生理反应时间来进行相关的计算：getBoundingClientRect 或 getComputedStyle，并通过 FLIP 技术使动画尽快开始，最后通过 transform 和 opacity 的动画来保证动画的平滑运行.</p><p>FLIP 技术带来的改变对于 PC 端可能并不是那么明显，但对于 CPU 并不算非常强大的移动端却是相当显著.</p>]]></content>
    
    <summary type="html">
    
      
      
        &lt;h1 id=&quot;今天的目标&quot;&gt;&lt;a href=&quot;#今天的目标&quot; class=&quot;headerlink&quot; title=&quot;今天的目标&quot;&gt;&lt;/a&gt;今天的目标&lt;/h1&gt;&lt;p&gt;&lt;img src=&quot;/assets/FLIP%E5%8A%A8%E7%94%BB%E7%AE%80%E4%BB%8B
      
    
    </summary>
    
    
    
  </entry>
  
  <entry>
    <title>使用simple-git编写一个git代码量统计工具</title>
    <link href="http://www.axin-blog.com/node-cli/git/%E4%BD%BF%E7%94%A8simple-git%E7%BC%96%E5%86%99%E4%B8%80%E4%B8%AAgit%E4%BB%A3%E7%A0%81%E9%87%8F%E7%BB%9F%E8%AE%A1%E5%B7%A5%E5%85%B7/"/>
    <id>http://www.axin-blog.com/node-cli/git/%E4%BD%BF%E7%94%A8simple-git%E7%BC%96%E5%86%99%E4%B8%80%E4%B8%AAgit%E4%BB%A3%E7%A0%81%E9%87%8F%E7%BB%9F%E8%AE%A1%E5%B7%A5%E5%85%B7/</id>
    <published>2020-08-17T13:13:19.000Z</published>
    <updated>2020-08-18T02:47:32.910Z</updated>
    
    <content type="html"><![CDATA[<h1 id="背景"><a href="#背景" class="headerlink" title="背景"></a>背景</h1><p>公司每周都要统计代码量。最近新入职，代码量不是很多，开始的时候，一直是直接在gitlab上看我的提交，一次一次地累加，好蠢有没有…</p><p>偶然之间，了解了刚离职的大佬同事以前是用shell脚本来自动统计的，大牛有木有！顺带帮传宣下：<a href="https://blog.towavephone.com/git-code-statistics-script/" target="_blank" rel="noopener">git代码统计脚本</a></p><p>最近，公司架构组大佬写了一个git自动部署的工具，加之我又没有被分配需求，就研究了一下。收获颇多，突发奇想，这个统计代码的工具，我干脆自己来写一个！</p><h1 id="使用到的库"><a href="#使用到的库" class="headerlink" title="使用到的库"></a>使用到的库</h1><ul><li><code>simple-git</code> <a href="https://github.com/steveukx/git-js#readme" target="_blank" rel="noopener">simple-git</a> 一个git的轻量级nodejs接口</li><li><code>chalk</code> <a href="https://github.com/chalk/chalk#readme" target="_blank" rel="noopener">chalk</a> 一个可以在控制台输出花里胡哨的颜色文字的炫酷工具</li><li><code>inquirer</code> <a href="https://github.com/SBoudrias/Inquirer.js#readme" target="_blank" rel="noopener">inquirer</a> 一个可以在控制台跟用户交互并且收集用户输入的参数的库</li></ul><h1 id="核心api"><a href="#核心api" class="headerlink" title="核心api"></a>核心api</h1><p>git相关：</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 新建git对象</span></span><br><span class="line"><span class="keyword">const</span> simpleGit = <span class="built_in">require</span>(<span class="string">'simple-git'</span>);</span><br><span class="line"><span class="keyword">const</span> git = simpleGit(<span class="string">'D:/xxx/xxx'</span>);</span><br><span class="line"></span><br><span class="line"><span class="comment">// 以下方法均返回promise</span></span><br><span class="line"><span class="comment">// 获取本地分支</span></span><br><span class="line">git.branchLocal()</span><br><span class="line"><span class="comment">// 切换到某个分支</span></span><br><span class="line">git.checkout(branch)</span><br><span class="line"><span class="comment">// 获取提交日志</span></span><br><span class="line">git.log(&#123;</span><br><span class="line">    <span class="string">'--stat'</span>: <span class="literal">true</span>,</span><br><span class="line">    <span class="string">'--since'</span>: <span class="string">'2020-01-01'</span>,</span><br><span class="line">    <span class="string">'--until'</span>: <span class="string">'2020-01-02'</span>,</span><br><span class="line">    <span class="string">'--author'</span>: <span class="string">'your name'</span></span><br><span class="line">  &#125;);</span><br></pre></td></tr></table></figure><p>交互相关：</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 单个参数输入</span></span><br><span class="line"><span class="keyword">const</span> &#123; workSpace &#125; = <span class="keyword">await</span> inquirer.prompt([&#123;</span><br><span class="line">    name: <span class="string">'workSpace'</span>,</span><br><span class="line">    message: <span class="string">'输入你的工作目录'</span>,</span><br><span class="line">    validate: <span class="function"><span class="params">answer</span> =&gt;</span> &#123;</span><br><span class="line">      <span class="keyword">try</span> &#123;</span><br><span class="line">        <span class="keyword">if</span> (!answer || !fs.statSync(answer.trim()).isDirectory) &#123;</span><br><span class="line">          <span class="keyword">return</span> <span class="string">'输入的路径不是合法的目录'</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> <span class="literal">true</span>;</span><br><span class="line">      &#125; <span class="keyword">catch</span> &#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="string">'输入的路径不是合法的目录'</span>;</span><br><span class="line">      &#125;</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;]);</span><br><span class="line"></span><br><span class="line"><span class="comment">// 列表多选</span></span><br><span class="line"><span class="keyword">const</span> &#123; projectList &#125; = <span class="keyword">await</span> inquirer.prompt(&#123;</span><br><span class="line">    name: <span class="string">'projectList'</span>,</span><br><span class="line">    message: <span class="string">'请选择要统计的项目，空格选择，回车结束选择'</span>,</span><br><span class="line">    type: <span class="string">'checkbox'</span>,</span><br><span class="line">    choices: [<span class="string">'projectA'</span>, <span class="string">'projectB'</span>, <span class="string">'projectC'</span>],</span><br><span class="line">    validate: <span class="function"><span class="params">checkedList</span> =&gt;</span> &#123;</span><br><span class="line">      <span class="keyword">return</span> checkedList.length &gt; <span class="number">0</span> || <span class="string">'请选择至少一个项目'</span>;</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;);</span><br></pre></td></tr></table></figure><p>控制台输出相关：</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">console</span>.log(chalk.green(<span class="string">'这句代码会在控制台输出绿色的字'</span>))</span><br></pre></td></tr></table></figure><h1 id="开始编写"><a href="#开始编写" class="headerlink" title="开始编写"></a>开始编写</h1><p>其实这些api都会使用了之后，我们这个工具的编写就变得非常简单了起来。这里我把主要思路写一下，具体代码请见文末贴出来的git地址</p><ol><li>输入工作目录</li><li>输入要统计的开始时间</li><li>输入要统计的结束时间</li><li>输入作者关键字</li><li>根据输入的工作目录，循环遍历目录中的子文件夹，如果子文件夹中有<code>.git</code>目录，则认为该目录是一个git项目，存入列表。最终得到一个项目列表，供用户选择要统计的项目。</li><li>根据用户选择后得到的项目列表，一一循环获得每个项目的本地分支，得到每个项目的分支列表。一一循环每个项目及每个分支，供用户选择要统计的分支。</li><li>根据得到的所有参数，循环项目，分支，一一统计得到每个分支，每个项目，及总共的代码变动量。</li><li>按照特定的格式输出结果。</li></ol><h1 id="体验一下"><a href="#体验一下" class="headerlink" title="体验一下"></a>体验一下</h1><p><img src="/assets/%E4%BD%BF%E7%94%A8simple-git%E7%BC%96%E5%86%99%E4%B8%80%E4%B8%AAgit%E4%BB%A3%E7%A0%81%E9%87%8F%E7%BB%9F%E8%AE%A1%E5%B7%A5%E5%85%B7/git-code-count.gif" alt="使用git-code-count"></p><div class="block tip-block"><p>在windows的cmd窗口中，偶尔会出现上面动图中标题输出多次的bug，目前不明真相。在vscode的终端中不会有这个问题。有空的时候继续研究一下。。</p></div><h1 id="代码仓库地址"><a href="#代码仓库地址" class="headerlink" title="代码仓库地址"></a>代码仓库地址</h1><p><a href="https://github.com/Axin2017/git-code-count" target="_blank" rel="noopener">git-code-count</a></p><p>欢迎使用，提出issues以及在博客上留言提出你想要的功能，我将会持续维护。</p><h1 id="显示多行后续"><a href="#显示多行后续" class="headerlink" title="显示多行后续"></a>显示多行后续</h1><p>在文章的上部分，我贴了一张体验动图，可以发现，当我按箭头上下切换的时候，重复显示了很多行</p><p>经过我后续的测试，发现，当标题为中文，且一行显示不完的时候，就会有这样的问题。所以大家使用的时候，最好把cmd窗口放大。要不然我就把我的问题改成英文的。。。暂时先放大吧哈哈。</p><p>对此我已经提了issue在原作者的github上。</p><p><a href="https://github.com/SBoudrias/Inquirer.js/issues/953" target="_blank" rel="noopener">it will render repeat lines of title on Windows when the property of message is Chinese and too long to display in a single line</a></p>]]></content>
    
    <summary type="html">
    
      
      
        &lt;h1 id=&quot;背景&quot;&gt;&lt;a href=&quot;#背景&quot; class=&quot;headerlink&quot; title=&quot;背景&quot;&gt;&lt;/a&gt;背景&lt;/h1&gt;&lt;p&gt;公司每周都要统计代码量。最近新入职，代码量不是很多，开始的时候，一直是直接在gitlab上看我的提交，一次一次地累加，好蠢有没有…&lt;/p&gt;

      
    
    </summary>
    
    
      <category term="node-cli" scheme="http://www.axin-blog.com/categories/node-cli/"/>
    
      <category term="git" scheme="http://www.axin-blog.com/categories/node-cli/git/"/>
    
    
      <category term="git" scheme="http://www.axin-blog.com/tags/git/"/>
    
  </entry>
  
  <entry>
    <title>hook异步更新问题</title>
    <link href="http://www.axin-blog.com/React/React-Hook/hook%E5%BC%82%E6%AD%A5%E6%9B%B4%E6%96%B0%E9%97%AE%E9%A2%98/"/>
    <id>http://www.axin-blog.com/React/React-Hook/hook%E5%BC%82%E6%AD%A5%E6%9B%B4%E6%96%B0%E9%97%AE%E9%A2%98/</id>
    <published>2020-08-03T11:27:50.000Z</published>
    <updated>2020-08-17T13:54:53.474Z</updated>
    
    <content type="html"><![CDATA[<p>在最近的工作中，初次尝试使用hook写一个完整的组件。果然第一次就遇到了问题。</p><h1 id="需求"><a href="#需求" class="headerlink" title="需求"></a>需求</h1><p>这里我们先不要管代码写的逻辑问题。我们需要一个下拉组件，用户可以多选，可以清空。每次修改的时候都会去判断是否为空，如果为空的话给出警告（非常简单）</p><h1 id="编码"><a href="#编码" class="headerlink" title="编码"></a>编码</h1><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"><span class="keyword">import</span> React, &#123; useState &#125; <span class="keyword">from</span> <span class="string">'react'</span>;</span><br><span class="line"><span class="keyword">import</span> &#123; fromJS &#125; <span class="keyword">from</span> <span class="string">'immutable'</span>;</span><br><span class="line"><span class="keyword">import</span> &#123; Select &#125; <span class="keyword">from</span> <span class="string">'antd'</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> &#123; Option &#125; = Select;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">HooksAsync</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line"></span><br><span class="line">  <span class="keyword">const</span> foodList = [<span class="string">'苹果'</span>, <span class="string">'梨'</span>, <span class="string">'米饭'</span>, <span class="string">'面条'</span>, <span class="string">'牛肉'</span>, <span class="string">'牛奶'</span>];</span><br><span class="line"></span><br><span class="line">  <span class="keyword">const</span> initCheckedFoods = &#123;</span><br><span class="line">    count: <span class="number">0</span>,</span><br><span class="line">    value: [],</span><br><span class="line">    error: <span class="string">''</span></span><br><span class="line">  &#125;;</span><br><span class="line"></span><br><span class="line">  <span class="keyword">const</span> [foods, setFoods] = useState(fromJS(initCheckedFoods));</span><br><span class="line"></span><br><span class="line">  <span class="keyword">const</span> handleChange = <span class="function">(<span class="params">value</span>) =&gt;</span> &#123;</span><br><span class="line">    setFoods(foods</span><br><span class="line">      .set(<span class="string">'value'</span>, fromJS(value))</span><br><span class="line">      .set(<span class="string">'count'</span>, value.length)</span><br><span class="line">    );</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">if</span> (value.length === <span class="number">0</span>) &#123;</span><br><span class="line">      setFoods(foods.set(<span class="string">'error'</span>, <span class="string">'不能为空'</span>))</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;;</span><br><span class="line"></span><br><span class="line">  <span class="keyword">return</span> (</span><br><span class="line">    &lt;&gt;</span><br><span class="line">      &lt;div&gt;</span><br><span class="line">        异常：&#123;foods.error&#125;</span><br><span class="line">      &lt;<span class="regexp">/div&gt;</span></span><br><span class="line"><span class="regexp">      &lt;Select</span></span><br><span class="line"><span class="regexp">        allowClear</span></span><br><span class="line"><span class="regexp">        mode="multiple"</span></span><br><span class="line"><span class="regexp">        style=&#123;&#123;width: 500&#125;&#125;</span></span><br><span class="line"><span class="regexp">        placeholder="请选择食物"</span></span><br><span class="line"><span class="regexp">        value=&#123;foods.get('value').toJS()&#125;</span></span><br><span class="line"><span class="regexp">        onChange=&#123;handleChange&#125;</span></span><br><span class="line"><span class="regexp">      &gt;</span></span><br><span class="line"><span class="regexp">        &#123;</span></span><br><span class="line"><span class="regexp">          foodList.map((food) =&gt; (</span></span><br><span class="line"><span class="regexp">            &lt;Option</span></span><br><span class="line"><span class="regexp">              key=&#123;food&#125;</span></span><br><span class="line"><span class="regexp">              value=&#123;food&#125;</span></span><br><span class="line"><span class="regexp">            &gt;</span></span><br><span class="line"><span class="regexp">              &#123;food&#125;</span></span><br><span class="line"><span class="regexp">            &lt;/</span>Option&gt;</span><br><span class="line">          ))</span><br><span class="line">        &#125;</span><br><span class="line">      &lt;<span class="regexp">/Select&gt;</span></span><br><span class="line"><span class="regexp">    &lt;/</span>&gt;</span><br><span class="line">  );</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">default</span> HooksAsync;</span><br></pre></td></tr></table></figure><h1 id="bug出现"><a href="#bug出现" class="headerlink" title="bug出现"></a>bug出现</h1><p><img src="/assets/hook%E5%BC%82%E6%AD%A5%E6%9B%B4%E6%96%B0%E9%97%AE%E9%A2%98/foods.gif" alt="点击清空和删除至最后一个无效"><br>当我们点击清除按钮以及删除至最后一个触发错误提示逻辑的时候，并没有把选择项清除掉。也没有出来我们期望的错误提示。</p><h1 id="bug定位"><a href="#bug定位" class="headerlink" title="bug定位"></a>bug定位</h1><p>经过摸爬滚打的排查。发现是因为hook和setState一样，更新操作是异步的。以上bug可以还原为这样子。</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> handleChange = <span class="function">(<span class="params">value</span>) =&gt;</span> &#123;</span><br><span class="line">  <span class="keyword">const</span> currentFoods = foods;</span><br><span class="line"></span><br><span class="line">  <span class="comment">// 修改currentFoods的value和count属性，返回新值赋值给foods </span></span><br><span class="line">  setFoods(currentFoods</span><br><span class="line">    .set(<span class="string">'value'</span>, fromJS(value))</span><br><span class="line">    .set(<span class="string">'count'</span>, value.length)</span><br><span class="line">  );</span><br><span class="line">  <span class="comment">// 这里拿到的还是currentFoods，而不是新的foods。immutablejs修改之后，会返回新的对象，原来的还是原来的。</span></span><br><span class="line">  <span class="comment">// 所以这里的currentFoods并没有value和count的改变。</span></span><br><span class="line">  <span class="comment">// 修改currentFoods的error属性，返回新值赋值给foods </span></span><br><span class="line">  <span class="keyword">if</span> (value.length === <span class="number">0</span>) &#123;</span><br><span class="line">    setFoods(currentFoods.set(<span class="string">'error'</span>, <span class="string">'不能为空'</span>))</span><br><span class="line">  &#125;</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure><p>可以看到，其实我们只是把修改了<code>error</code>的新值赋值给了<code>foods</code>而已。第一个<code>setFoods</code>完全被忽略了。</p><h1 id="怎么解决"><a href="#怎么解决" class="headerlink" title="怎么解决"></a>怎么解决</h1><ul><li>使用函数做参数，和setState一样</li></ul><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">if</span> (value.length === <span class="number">0</span>) &#123;</span><br><span class="line">  setFoods(<span class="function">(<span class="params">foods</span>) =&gt;</span> foods.set(<span class="string">'error'</span>, <span class="string">'不能为空'</span>))</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><ul><li>useRef</li></ul><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> [foods, setFoods] = useState(fromJS(initCheckedFoods));</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> foodRef = useRef(foods);</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> handleChange = <span class="function">(<span class="params">value</span>) =&gt;</span> &#123;</span><br><span class="line">  setFoods(foodRef.current</span><br><span class="line">    .set(<span class="string">'value'</span>, fromJS(value))</span><br><span class="line">    .set(<span class="string">'count'</span>, value.length)</span><br><span class="line">  );</span><br><span class="line">  </span><br><span class="line">  <span class="keyword">if</span> (value.length === <span class="number">0</span>) &#123;</span><br><span class="line">    setFoods(foodRef.current.set(<span class="string">'error'</span>, <span class="string">'不能为空'</span>))</span><br><span class="line">  &#125;</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure><h1 id="总结"><a href="#总结" class="headerlink" title="总结"></a>总结</h1><p>和 <code>setState</code> 一样，其实hook更新数据也是异步的。这个其实在react常用的人手上是不会出这个问题的。奈何我一个新手还是去淌了一遍。。</p>]]></content>
    
    <summary type="html">
    
      
      
        &lt;p&gt;在最近的工作中，初次尝试使用hook写一个完整的组件。果然第一次就遇到了问题。&lt;/p&gt;
&lt;h1 id=&quot;需求&quot;&gt;&lt;a href=&quot;#需求&quot; class=&quot;headerlink&quot; title=&quot;需求&quot;&gt;&lt;/a&gt;需求&lt;/h1&gt;&lt;p&gt;这里我们先不要管代码写的逻辑问题。我们需要一个
      
    
    </summary>
    
    
      <category term="React" scheme="http://www.axin-blog.com/categories/React/"/>
    
      <category term="React-Hook" scheme="http://www.axin-blog.com/categories/React/React-Hook/"/>
    
    
      <category term="Hook, async" scheme="http://www.axin-blog.com/tags/Hook-async/"/>
    
  </entry>
  
  <entry>
    <title>Route组件渲染的几种方式</title>
    <link href="http://www.axin-blog.com/React/React-Router/Route%E7%BB%84%E4%BB%B6%E6%B8%B2%E6%9F%93%E7%9A%84%E5%87%A0%E7%A7%8D%E6%96%B9%E5%BC%8F/"/>
    <id>http://www.axin-blog.com/React/React-Router/Route%E7%BB%84%E4%BB%B6%E6%B8%B2%E6%9F%93%E7%9A%84%E5%87%A0%E7%A7%8D%E6%96%B9%E5%BC%8F/</id>
    <published>2020-07-28T08:51:40.000Z</published>
    <updated>2020-08-04T13:20:56.889Z</updated>
    
    <content type="html"><![CDATA[<p><code>&lt;Route&gt;</code> 组件是 <code>React-Router</code> 提供的用于当路由匹配上之后渲染用户组件的一个组件</p><h1 id="渲染组件的方式"><a href="#渲染组件的方式" class="headerlink" title=" 渲染组件的方式"></a><Route> 渲染组件的方式</h1><h2 id="component"><a href="#component" class="headerlink" title="component"></a>component</h2><p>比较容易理解，直接传递一个组件。官网示例:</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> React <span class="keyword">from</span> <span class="string">"react"</span>;</span><br><span class="line"><span class="keyword">import</span> ReactDOM <span class="keyword">from</span> <span class="string">"react-dom"</span>;</span><br><span class="line"><span class="keyword">import</span> &#123; BrowserRouter <span class="keyword">as</span> Router, Route &#125; <span class="keyword">from</span> <span class="string">"react-router-dom"</span>;</span><br><span class="line"></span><br><span class="line"><span class="comment">// All route props (match, location and history) are available to User</span></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">User</span>(<span class="params">props</span>) </span>&#123;</span><br><span class="line">  <span class="keyword">return</span> <span class="xml"><span class="tag">&lt;<span class="name">h1</span>&gt;</span>Hello &#123;props.match.params.username&#125;!<span class="tag">&lt;/<span class="name">h1</span>&gt;</span></span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">ReactDOM.render(</span><br><span class="line">  &lt;Router&gt;</span><br><span class="line">    &lt;Route path=<span class="string">"/user/:username"</span> component=&#123;User&#125; /&gt;</span><br><span class="line">  &lt;<span class="regexp">/Router&gt;,</span></span><br><span class="line"><span class="regexp">  node</span></span><br><span class="line"><span class="regexp">);</span></span><br></pre></td></tr></table></figure><div class="block danger-block"><p>不要尝试用内联方法的方式赋值给 <code>component</code> 属性，如以下示例所示：</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&lt;Route path=<span class="string">"/user/:username"</span> component=&#123;() =&gt; <span class="xml"><span class="tag">&lt;<span class="name">User</span> /&gt;</span></span>)&#125; /&gt;</span><br></pre></td></tr></table></figure><p>这样会导致每次重新渲染的时候都是一个新的 <code>User</code> 组件</p></div><h2 id="render-function"><a href="#render-function" class="headerlink" title="render function"></a>render function</h2><p>在某些情况下，我们可能希望能经过一些计算来在一个路由上显示不同的组件。如下所示：</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> React <span class="keyword">from</span> <span class="string">"react"</span>;</span><br><span class="line"><span class="keyword">import</span> ReactDOM <span class="keyword">from</span> <span class="string">"react-dom"</span>;</span><br><span class="line"><span class="keyword">import</span> &#123; BrowserRouter <span class="keyword">as</span> Router, Route &#125; <span class="keyword">from</span> <span class="string">"react-router-dom"</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> day = <span class="number">1</span>;</span><br><span class="line"></span><br><span class="line"><span class="comment">// convenient inline rendering</span></span><br><span class="line">ReactDOM.render(</span><br><span class="line">  &lt;Router&gt;</span><br><span class="line">    &lt;Route path=<span class="string">"/home"</span> render=&#123;(props) =&gt; &#123;</span><br><span class="line">      <span class="keyword">if</span>(day === <span class="number">1</span>) &#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="xml"><span class="tag">&lt;<span class="name">Monday</span> /&gt;</span></span></span><br><span class="line">      &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="xml"><span class="tag">&lt;<span class="name">NotMonday</span> /&gt;</span></span></span><br><span class="line">      &#125;</span><br><span class="line">    &#125;&#125; /&gt;</span><br><span class="line">  &lt;<span class="regexp">/Router&gt;,</span></span><br><span class="line"><span class="regexp">  node</span></span><br><span class="line"><span class="regexp">);</span></span><br></pre></td></tr></table></figure><div class="block tip-block"><ul><li>与将内联方法传递给 <code>component</code> 属性不同，使用此方式，不会造成组件的重复渲染</li><li><code>props</code> 参数为 <code>{ match, location, history }</code></div></li></ul><div class="block warn-block"><p><code>component</code> 属性的优先级要高于 <code>render</code> 。避免将两个属性同时使用在一个路由组件上。</p></div><h2 id="children-function"><a href="#children-function" class="headerlink" title="children function"></a>children function</h2><p><code>children function</code> 与 <code>render function</code> 的使用方式一样。不同的地方在于，当路由匹配失败后，<code>match</code> 参数会是 <code>null</code> 。<br>我们可以根据这个特性来做一些事情。</p><p>官网代码示例，这里在匹配上的时候，增加了一个class：</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> React <span class="keyword">from</span> <span class="string">"react"</span>;</span><br><span class="line"><span class="keyword">import</span> ReactDOM <span class="keyword">from</span> <span class="string">"react-dom"</span>;</span><br><span class="line"><span class="keyword">import</span> &#123;</span><br><span class="line">  BrowserRouter <span class="keyword">as</span> Router,</span><br><span class="line">  Link,</span><br><span class="line">  Route</span><br><span class="line">&#125; <span class="keyword">from</span> <span class="string">"react-router-dom"</span>;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">ListItemLink</span>(<span class="params">&#123; to, ...rest &#125;</span>) </span>&#123;</span><br><span class="line">  <span class="keyword">return</span> (</span><br><span class="line">    &lt;Route</span><br><span class="line">      path=&#123;to&#125;</span><br><span class="line">      children=&#123;(&#123; match &#125;) =&gt; (</span><br><span class="line">        &lt;li className=&#123;match ? <span class="string">"active"</span> : <span class="string">""</span>&#125;&gt;</span><br><span class="line">          &lt;Link to=&#123;to&#125; &#123;...rest&#125; /&gt;</span><br><span class="line">        &lt;<span class="regexp">/li&gt;</span></span><br><span class="line"><span class="regexp">      )&#125;</span></span><br><span class="line"><span class="regexp">    /</span>&gt;</span><br><span class="line">  );</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">ReactDOM.render(</span><br><span class="line">  &lt;Router&gt;</span><br><span class="line">    &lt;ul&gt;</span><br><span class="line">      &lt;ListItemLink to=<span class="string">"/somewhere"</span> /&gt;</span><br><span class="line">      &lt;ListItemLink to=<span class="string">"/somewhere-else"</span> /&gt;</span><br><span class="line">    &lt;<span class="regexp">/ul&gt;</span></span><br><span class="line"><span class="regexp">  &lt;/</span>Router&gt;,</span><br><span class="line">  node</span><br><span class="line">);</span><br></pre></td></tr></table></figure><div class="block warn-block"><p><code>children</code> 属性的优先级要高于 <code>render</code> 和 <code>component</code> 。避免将多个属性同时使用在一个路由组件上。</p></div>]]></content>
    
    <summary type="html">
    
      
      
        &lt;p&gt;&lt;code&gt;&amp;lt;Route&amp;gt;&lt;/code&gt; 组件是 &lt;code&gt;React-Router&lt;/code&gt; 提供的用于当路由匹配上之后渲染用户组件的一个组件&lt;/p&gt;
&lt;h1 id=&quot;渲染组件的方式&quot;&gt;&lt;a href=&quot;#渲染组件的方式&quot; class=&quot;headerli
      
    
    </summary>
    
    
      <category term="React" scheme="http://www.axin-blog.com/categories/React/"/>
    
      <category term="React-Router" scheme="http://www.axin-blog.com/categories/React/React-Router/"/>
    
    
      <category term="Route-Render" scheme="http://www.axin-blog.com/tags/Route-Render/"/>
    
  </entry>
  
</feed>
